<html>
 <head>
  <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
  <title>
   Vijos - P3035
  </title>
  <meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
  <meta content="No-cach" http-equiv="Pragma"/>
  <meta content="Vijos,Velocious Informatics Judge Online System,高效信息学在线评测系统,湖南师大附中,Vivian Snow,Vivian Utopia,Viviworks,信息学,评测,OJ" name="Kyewords"/>
  <meta content="Vijos,Velocious Informatics Judge Online System" name="Description"/>
  <meta content="All" name="Robots"/>
  <meta content="Vivian Snow,VivianSnow@Gmail.com" name="Author"/>
  <meta content="Copyright Vijos (c) 2005. www.Vijos.cn Powered by Vivian Snow" name="Copyright"/>
  <meta content="Dreamweaver,Visual Studio .net 2003" name="Generator "/>
  <link href="Skin/Life Azure/Style.css" rel="stylesheet" type="text/css"/>
  <meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
 </head>
 <body>
  <div align="center">
   <table border="0" cellpadding="0" cellspacing="0" width="750">
    <tr>
     <td align="center" colspan="2">
      <a href="Index.html">
       <img border="0" height="70" src="Skin/Life Azure/Haed.gif" usemap="#MapHead" width="750"/>
      </a>
      <map id="MapHead" name="MapHead">
       <area alt="点击这里更换您喜欢的皮肤" coords="71,1,153,21" href="Skin.asp" shape="rect">
       </area>
       <area alt="Vijos 首页" coords="0,0,750,70" href="Index.asp" shape="rect">
       </area>
      </map>
     </td>
    </tr>
    <tr>
     <td align="right" bgcolor="#174B73" height="25">
      <font class="styletext">
      </font>
      <a href="Index.html">
       <font class="style3">
        首页
       </font>
      </a>
      <font class="style3">
       |
      </font>
      <a href="peixun.html">
       <font class="style3">
        [NOIP培训]
       </font>
      </a>
      <a href="kaoshi2020.html">
       <font class="style3">
        考试
       </font>
      </a>
      <a href="Problem.html">
       <font class="style3">
        题库
       </font>
      </a>
      <a href="Record.html">
       <font class="style3">
        记录
       </font>
      </a>
      <a href="Rank.html">
       <font class="style3">
        排名
       </font>
      </a>
      <a href="Group.html">
       <font class="style3">
        团队
       </font>
      </a>
      <a href="Discuss.html">
       <font class="style3">
        讨论
       </font>
      </a>
      <font class="style3">
       |
      </font>
      <a href="USpace.html">
       <font class="style3">
        空间
       </font>
      </a>
      <a href="Logout.html">
       <font class="style3">
        登出
       </font>
      </a>
     </td>
     <td align="center" bgcolor="#174B73">
     </td>
    </tr>
    <tr>
     <td bgcolor="#1B5987" colspan="2" height="5">
     </td>
    </tr>
    <tr>
     <td align="center" bgcolor="#1B5987" colspan="2">
      <table bgcolor="#FFFFFF" border="0" cellpadding="0" cellspacing="0" height="0">
       <tr>
        <td background="Skin/Life Azure/Frame_r1_c1.gif" height="14" width="14">
        </td>
        <td background="Skin/Life Azure/Frame_r1_c2.gif">
        </td>
        <td background="Skin/Life Azure/Frame_r1_c3.gif" height="14" width="14">
        </td>
       </tr>
       <tr>
        <td background="Skin/Life Azure/Frame_r2_c1.gif">
        </td>
        <td align="left" valign="middle" width="712">
         <marquee align="right" direction="left" onmouseout="this.start();" onmouseover="this.stop();" scrollamount="4">
          <font color="#003366">
           <b>
            公告 News &gt;&gt;
           </b>
          </font>
          <a href="News#23.html">
           <font color="#006699">
            <b>
             欢迎新同学
            </b>
            (2017/7/14 10:18:56)
           </font>
          </a>
         </marquee>
        </td>
        <td background="Skin/Life Azure/Frame_r2_c3.gif">
        </td>
       </tr>
       <tr>
        <td background="Skin/Life Azure/Frame_r3_c1.gif" height="14" width="14">
        </td>
        <td background="Skin/Life Azure/Frame_r3_c2.gif">
        </td>
        <td background="Skin/Life Azure/Frame_r3_c3.gif" height="14" width="14">
        </td>
       </tr>
      </table>
     </td>
    </tr>
    <table border="0" cellpadding="0" cellspacing="0" width="750">
     <tr>
      <td align="center" bgcolor="#1B5987" colspan="2">
       <script>
        document.title=document.title+" - 狼的复仇"
       </script>
       <table bgcolor="#FFFFFF" border="0" cellpadding="0" cellspacing="0" height="0">
        <tr>
         <td background="Skin/Life Azure/Frame_r1_c1.gif" height="14" width="14">
         </td>
         <td background="Skin/Life Azure/Frame_r1_c2.gif">
         </td>
         <td background="Skin/Life Azure/Frame_r1_c3.gif" height="14" width="14">
         </td>
        </tr>
        <tr>
         <td background="Skin/Life Azure/Frame_r2_c1.gif">
         </td>
         <td align="left" valign="top" width="712">
          <table align="right" border="0" cellpadding="0" cellspacing="0" width="320">
           <tr align="center">
            <td>
             <span style="font-weight: bold">
              <a href="Problem_Upload_3035.html">
               【提交】
              </a>
             </span>
            </td>
            <td>
             <span style="font-weight: bold">
              <a href="Problem_record_3035.html">
               【记录】
              </a>
             </span>
            </td>
            <td>
             <span style="font-weight: bold">
              <a href="Problem_status_3035.html">
               【状态】
              </a>
             </span>
            </td>
            <td>
             <span style="font-weight: bold">
              <a href="Problem_Discuss_3035.html">
               【讨论】
              </a>
             </span>
            </td>
            <td>
             <span style="font-weight: bold">
              <a href="Problem_Solve_3035.html">
               【题解】
              </a>
             </span>
            </td>
           </tr>
          </table>
          <a href="Problem_Show_3035.html">
           <font class="style1">
            狼的复仇
           </font>
          </a>
         </td>
         <td background="Skin/Life Azure/Frame_r2_c3.gif">
         </td>
        </tr>
        <tr>
         <td background="Skin/Life Azure/Frame_r2_c1.gif">
         </td>
         <td>
          <hr/>
          <table bgcolor="#FFFFFF" border="0" cellpadding="0" cellspacing="0" height="0">
           <tr>
            <td align="left" valign="top" width="10">
            </td>
            <td align="left" valign="top" width="702">
             时间限制：1秒  内存限制：64M
            </td>
           </tr>
          </table>
         </td>
         <td background="Skin/Life Azure/Frame_r2_c3.gif">
         </td>
        </tr>
        <tr>
         <td background="Skin/Life Azure/Frame_r3_c1.gif" height="14" width="14">
         </td>
         <td background="Skin/Life Azure/Frame_r3_c2.gif">
         </td>
         <td background="Skin/Life Azure/Frame_r3_c3.gif" height="14" width="14">
         </td>
        </tr>
       </table>
       <table border="0" cellpadding="0" cellspacing="0" width="740">
        <tr>
         <td valign="top" width="740">
          <table bgcolor="#FFFFFF" border="0" cellpadding="0" cellspacing="0" height="0">
           <tr>
            <td background="Skin/Life Azure/Frame_r1_c1.gif" height="14" width="14">
            </td>
            <td background="Skin/Life Azure/Frame_r1_c2.gif" colspan="2">
            </td>
            <td background="Skin/Life Azure/Frame_r1_c3.gif" height="14" width="14">
            </td>
           </tr>
           <tr>
            <td background="Skin/Life Azure/Frame_r2_c1.gif" rowspan="2">
            </td>
            <td align="left" bgcolor="#EFFFFF" class="style2" colspan="2" height="25" valign="middle" width="712">
             【问题描述】
            </td>
            <td background="Skin/Life Azure/Frame_r2_c3.gif" rowspan="2">
            </td>
           </tr>
           <tr>
            <td align="left" valign="top" width="10">
            </td>
            <td align="left" valign="top" width="702">
             <br/>
             山谷里有n座森林，这些森林从1到n编号。总共m条小路连通了这n座森林，任意两座森林之间都有至少一条路径可以互相到达。很久以前，这里是狼的家园。在每一座森林里都有一匹狼。直到有一天，人类出现了。它们疯狂地开垦1号森林，并且杀死了1号森林的狼。以后，不时有人来到1号森林。其余的n-1匹狼不愿看到悲剧再次发生，它们希望集合它们的力量，为种族，为大自然报仇。
             <br/>
             <br/>
             机会来了。一次偶然的机会，大灰狼们获得了一个重要的情报——有一个小MM经常独自游荡于1号森林。唯一的问题是，它们需要尽快察觉小MM的出现并快速奔向目的地。但由于山谷地形复杂，在第一时间里观察到小MM的出现谈何容易。因此，狼群计划在某些森林建立瞭望塔。当小MM再次出现在1号森林里时，所在的森林里有瞭望塔的狼可以立即发现这一情况，并且沿着最短路径奔向MM。有时最短路不止一条，在途中每当有多条路可以选择时，狼总会选择前往编号较小的森林。这些狼的行动将唤起最短路上沿途经过的狼，这些最短路上的狼将会闻声而起，一同对MM发起进攻。每匹狼都有自己的攻击力，最终对小MM的攻击力即是所有到达1号森林的狼的攻击力总和。注意攻击力的值有可能为负数，因为有一些狼很可能会“拖后腿”，对整个种族的复仇计划反而不利。
             <br/>
             <br/>
             由于森林的地形不同，在不同的地方建造瞭望塔需要的材料不同。现在狼群里一共有k个单位的建筑材料，并且它们已经计算出在n-1座森林中建造瞭望塔各自需要的材料数目。请你来计算一下，在哪些森林里建造瞭望塔可以使得最终到达1号森林的狼群攻击力总和最大。当然，建筑材料不一定要全部用完，但你的方案所需要的建筑材料不能超过总的材料数k。
             <br/>
            </td>
           </tr>
          </table>
          <table bgcolor="#FFFFFF" border="0" cellpadding="0" cellspacing="0" height="0">
           <tr>
            <td background="Skin/Life Azure/Frame_r2_c1.gif" width="14">
            </td>
            <td align="left" class="style2" colspan="2" height="20" valign="top" width="712">
            </td>
            <td background="Skin/Life Azure/Frame_r2_c3.gif" width="14">
            </td>
           </tr>
           <tr>
            <td background="Skin/Life Azure/Frame_r2_c1.gif" rowspan="2" width="14">
            </td>
            <td align="left" bgcolor="#EFFFFF" class="style2" colspan="2" height="25" valign="middle" width="712">
             【输入格式】
            </td>
            <td background="Skin/Life Azure/Frame_r2_c3.gif" rowspan="2" width="14">
            </td>
           </tr>
           <tr>
            <td align="left" valign="top" width="10">
             &amp;nbsp
            </td>
            <td align="left" valign="top" width="702">
             <br/>
             第一行输入三个用空格隔开的正整数k, n, m，分别表示材料的总数量，森林的数量和小路的数量。1号森林总是MM出没的地方，其余n-1座森林是狼所在的地方。
             <br/>
             第二行到第n行每行有两个用空格隔开的整数，依次表示2号森林到n号森林里的狼的攻击力和在这里建造瞭望塔所需要的材料数。狼的攻击力绝对值不超过10000（可能为负数），每个瞭望塔的材料耗费都是不超过100的正整数。
             <br/>
             接下来m行每行有三个用空格隔开的数x,y,d，表示在x森林和y森林之间存在一条长度为d的路。路的长度是不超过10000的正整数。
             <br/>
             <br/>
            </td>
           </tr>
          </table>
          <table bgcolor="#FFFFFF" border="0" cellpadding="0" cellspacing="0" height="0">
           <tr>
            <td background="Skin/Life Azure/Frame_r2_c1.gif" width="14">
            </td>
            <td align="left" class="style2" colspan="2" height="10" valign="top" width="712">
            </td>
            <td background="Skin/Life Azure/Frame_r2_c3.gif" width="14">
            </td>
           </tr>
           <tr>
            <td background="Skin/Life Azure/Frame_r2_c1.gif" rowspan="2" width="14">
            </td>
            <td align="left" bgcolor="#EFFFFF" class="style2" colspan="2" height="20" valign="middle" width="712">
             【输出格式】
            </td>
            <td background="Skin/Life Azure/Frame_r2_c3.gif" rowspan="2" width="14">
            </td>
           </tr>
           <tr>
            <td align="left" valign="top" width="10">
            </td>
            <td align="left" valign="top" width="702">
             <br/>
             输出在满足材料数限制下建造瞭望塔，最多可以给MM带去多大的攻击力。
             <br/>
            </td>
           </tr>
          </table>
          <table bgcolor="#FFFFFF" border="0" cellpadding="0" cellspacing="0" height="0">
           <tr>
            <td background="Skin/Life Azure/Frame_r2_c1.gif" width="14">
            </td>
            <td align="left" class="style2" colspan="2" height="20" valign="top" width="712">
            </td>
            <td background="Skin/Life Azure/Frame_r2_c3.gif" width="14">
            </td>
           </tr>
           <tr>
            <td background="Skin/Life Azure/Frame_r2_c1.gif" rowspan="2" width="14">
            </td>
            <td align="left" bgcolor="#EFFFFF" class="style2" colspan="2" height="20" valign="middle" width="712">
             【输入样例】
            </td>
            <td background="Skin/Life Azure/Frame_r2_c3.gif" rowspan="2" width="14">
            </td>
           </tr>
           <tr>
            <td align="left" valign="top" width="10">
            </td>
            <td align="left" valign="top" width="702">
             <br/>
             8 7 10
             <br/>
             1 4
             <br/>
             1 2
             <br/>
             2 4
             <br/>
             -3 5
             <br/>
             9 4
             <br/>
             2 1
             <br/>
             1 4 2
             <br/>
             4 3 4
             <br/>
             2 3 3
             <br/>
             5 1 2
             <br/>
             2 4 1
             <br/>
             1 2 3
             <br/>
             6 7 1
             <br/>
             2 7 4
             <br/>
             2 6 8
             <br/>
             5 6 5
             <br/>
            </td>
           </tr>
          </table>
          <table bgcolor="#FFFFFF" border="0" cellpadding="0" cellspacing="0" height="0">
           <tr>
            <td background="Skin/Life Azure/Frame_r2_c1.gif" width="14">
            </td>
            <td align="left" class="style2" colspan="2" height="20" valign="top" width="712">
            </td>
            <td background="Skin/Life Azure/Frame_r2_c3.gif" width="14">
            </td>
           </tr>
           <tr>
            <td background="Skin/Life Azure/Frame_r2_c1.gif" rowspan="2" width="14">
            </td>
            <td align="left" bgcolor="#EFFFFF" class="style2" colspan="2" height="20" valign="middle" width="712">
             【输出样例】
            </td>
            <td background="Skin/Life Azure/Frame_r2_c3.gif" rowspan="2" width="14">
            </td>
           </tr>
           <tr>
            <td align="left" valign="top" width="10">
            </td>
            <td align="left" valign="top" width="702">
             <br/>
             10
             <br/>
            </td>
           </tr>
          </table>
          <table bgcolor="#FFFFFF" border="0" cellpadding="0" cellspacing="0" height="0">
           <tr>
            <td background="Skin/Life Azure/Frame_r2_c1.gif" width="14">
            </td>
            <td align="left" class="style2" colspan="2" height="20" valign="top" width="712">
            </td>
            <td background="Skin/Life Azure/Frame_r2_c3.gif" width="14">
            </td>
           </tr>
           <tr>
            <td background="Skin/Life Azure/Frame_r2_c1.gif" rowspan="2" width="14">
            </td>
            <td align="left" bgcolor="#EFFFFF" class="style2" colspan="2" height="20" valign="middle" width="712">
             【样例解释】
            </td>
            <td background="Skin/Life Azure/Frame_r2_c3.gif" rowspan="2" width="14">
            </td>
           </tr>
           <tr>
            <td align="left" valign="top" width="10">
            </td>
            <td align="left" valign="top" width="702">
             <br/>
             输入数据如下图所示，我们用AP来表示攻击力，用cost来表示瞭望塔的材料花费。在涂有蓝色的节点上建造瞭望塔花费仅为7，由于7&lt;=8，因此这种方案未超过材料预算。我们下面计算这种方案所带来的攻击力。
             <br/>
             <img src="ProblemImg/P3035.jpg"/>
             <br/>
             这三匹狼的行走路线已经用箭头表示了出来。注意3号森林和7号森林的狼有多个到达节点1的最短路径，它总是选择标号较小的节点前进。这些路线经过了两个绿色的节点，这两个绿色的节点所对应的狼的攻击力也将加入总攻击力中（必须加入计算且仅算一次）。这种方案的攻击力为1+1+2+9-3=10。事实上，攻击力最大为10，没有其它的建造方案使得总攻击力大于10且材料花费不超过8。
             <br/>
            </td>
           </tr>
          </table>
          <table bgcolor="#FFFFFF" border="0" cellpadding="0" cellspacing="0" height="0">
           <tr>
            <td background="Skin/Life Azure/Frame_r2_c1.gif" width="14">
            </td>
            <td align="left" class="style2" colspan="2" height="20" valign="top" width="712">
            </td>
            <td background="Skin/Life Azure/Frame_r2_c3.gif" width="14">
            </td>
           </tr>
           <tr>
            <td background="Skin/Life Azure/Frame_r2_c1.gif" rowspan="2" width="14">
            </td>
            <td align="left" bgcolor="#EFFFFF" class="style2" colspan="2" height="20" valign="middle" width="712">
             【数据范围】
            </td>
            <td background="Skin/Life Azure/Frame_r2_c3.gif" rowspan="2" width="14">
            </td>
           </tr>
           <tr>
            <td align="left" valign="top" width="10">
            </td>
            <td align="left" valign="top" width="702">
             <br/>
             30%的数据， k&lt;=1, n&lt;=10, m&lt;=100
             <br/>
             50%的数据， k&lt;=10, n&lt;=100, m&lt;=1000
             <br/>
             100%的数据，k&lt;=100, n&lt;=1000, m&lt;=10000
             <br/>
             <br/>
             <br/>
             <br/>
             <br/>
             <br/>
            </td>
           </tr>
          </table>
         </td>
        </tr>
       </table>
       <table bgcolor="#FFFFFF" border="0" cellpadding="0" cellspacing="0" height="0">
        <tr>
         <td background="Skin/Life Azure/Frame_r1_c1.gif" height="14" width="14">
         </td>
         <td background="Skin/Life Azure/Frame_r1_c2.gif">
         </td>
         <td background="Skin/Life Azure/Frame_r1_c3.gif" height="14" width="14">
         </td>
        </tr>
        <tr>
         <td background="Skin/Life Azure/Frame_r2_c1.gif">
         </td>
         <td align="left" valign="top" width="712">
          <table align="right" border="0" cellpadding="0" cellspacing="0" width="320">
           <tr align="right">
            <td>
             <span style="font-weight: bold">
              <a href="Problem_Upload_3035.html">
               【提交】
              </a>
             </span>
            </td>
            <td>
             <span style="font-weight: bold">
              <a href="Problem_record_3035.html">
               【记录】
              </a>
             </span>
            </td>
            <td>
             <span style="font-weight: bold">
              <a href="Problem_status_3035.html">
               【状态】
              </a>
             </span>
            </td>
            <td>
             <span style="font-weight: bold">
              <a href="Problem_Discuss_3035.html">
               【讨论】
              </a>
             </span>
            </td>
            <td>
             <span style="font-weight: bold">
              <a href="Problem_Solve_3035.html">
               【题解】
              </a>
             </span>
            </td>
           </tr>
          </table>
         </td>
         <td background="Skin/Life Azure/Frame_r2_c3.gif">
         </td>
        </tr>
        <tr>
         <td background="Skin/Life Azure/Frame_r3_c1.gif" height="14" width="14">
         </td>
         <td background="Skin/Life Azure/Frame_r3_c2.gif">
         </td>
         <td background="Skin/Life Azure/Frame_r3_c3.gif" height="14" width="14">
         </td>
        </tr>
       </table>
      </td>
     </tr>
     <tr>
      <td bgcolor="#1B5987" colspan="2" height="5">
      </td>
     </tr>
     <tr>
      <td bgcolor="#003366" colspan="2" height="5">
      </td>
     </tr>
    </table>
    <table border="0" cellpadding="0" cellspacing="0" width="750">
     <tr>
      <td align="center" colspan="2" height="50">
       <table border="0" cellpadding="0" cellspacing="0" width="100%">
        <tr>
         <td align="left" valign="top">
          Copyright Vijos © 2005-2006.www.Vijos.cn Powered by
          <a href="http://www.VivianSnow.cn.html" target="_blank">
           Vivian Snow
          </a>
          <a href="About.html">
           <strong>
            关于
           </strong>
          </a>
          <a href="Contact.html">
           <strong>
            联系
           </strong>
          </a>
          <a href="Help.html">
           <strong>
            帮助
           </strong>
          </a>
          <br/>
          <span style="font-size: 9px">
           Vijos Information ----
           <a href="Rank.html">
            Total Users : 1495
           </a>
           |
           <a href="Online.html">
            Online Users / Processes : 2 / 5
           </a>
           | Processed Time : 31 ms | Server Time : 2018/1/23 21:41:03
          </span>
         </td>
         <td valign="top" width="60">
         </td>
        </tr>
       </table>
      </td>
     </tr>
    </table>
    <style>
     #UserShowInfo {
	position:absolute;
	left:0;
	top:0;
	width:100%;
	height:68px;
	z-index:100;
	cursor: hand;
	filter: Alpha(Opacity=10, FinishOpacity=20, Style=1, StartX=0, StartY=0, FinishX=0, FinishY=70);
}
    </style>
    <div id="UserShowInfo">
     <div align="center">
      <table border="0" cellpadding="0" cellspacing="0" width="440">
       <tr>
        <td height="2">
        </td>
       </tr>
       <tr>
        <td>
         <table align="left" bgcolor="#CCCCCC" border="0" cellpadding="0" cellspacing="1" width="0">
          <tr>
           <td>
            <table align="left" bgcolor="#FFFFFF" border="0" cellpadding="5" cellspacing="0" width="100%">
             <tr>
              <td rowspan="2" width="48">
               <img height="48" src="Face/Face9.gif" width="48"/>
              </td>
              <td>
               <div align="center">
                <a href="User_Show_2063.html" title="U2063 - 通过255题 - Member - 高2020级A班 - P3159">
                 <font color="#CC9966">
                  <strong>
                   莫洛托夫鸡尾酒
                  </strong>
                 </font>
                </a>
               </div>
              </td>
             </tr>
             <tr>
              <td bordercolor="" dir="">
               <div align="center">
                <img height="12" src="Face/stars4.gif" width="64"/>
                <img height="12" src="Img/Sex_1.gif" width="10"/>
               </div>
              </td>
             </tr>
            </table>
           </td>
          </tr>
         </table>
        </td>
       </tr>
      </table>
     </div>
    </div>
   </table>
  </div>
 </body>
</html>
